<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Vk api test</title>
	<script src="https://vk.com/js/api/openapi.js?136" type="text/javascript"></script>
	<script>
	new Promise(function(resolve) {
 		if (document.readyState === 'complete') {
 			resolve();
 		} else {
 			window.onload = resolve;
 		}
	}).then(function() {
 		return new Promise(function(resolve, reject) {
 			VK.init({
				apiId: 5759873
 			});
 			VK.Auth.login(function(response) {
				if (response.session) {
					resolve(response);
				} else {
					reject(new Error('Не удалось авторизоваться'));
 				}
 			}, 8);
 		});
	}).then(function() {
 		return new Promise(function(resolve, reject) {
 			VK.api('users.get', {'name_case': 'gen'}, 
 				function(response) {
 					if (response.error) {
 						reject(new Error(response.error.error_msg));
 					} else {
 						headerInfo.textContent = 'Музыка на странице'
						+ response.response[0].first_name + ' ' + response.
						response[0].last_name;
						
 						resolve(response.response[0].uid);
 					}
 			});
 		})
	}).then(function(uid) {
		return new Promise(function(resolve, reject) {
			console.log('uid', uid);
			VK.api('friends.get', {
				'user_id': uid,
				'count': 3,
				'fields': ['domain', 'city']
			}, function(response) {
				if(response.error) {
					reject(new Error(response.error.error_msg));
				} else {
					console.log('res: ', response);
					resolve();
				}
			})
		});
	}).catch(function(e) {
		alert('Ошибка: ' + e.message);
	});
	</script>
</head>
<body>
	<!-- 5759873 -->
	<div class="container">
		<div class="friends">
			<div class="friends__head" id="headerInfo"></div>
			<div class="friends__content">
				<div class="list list--item1">
					<div class="splash">
						<input type="search" class="search_input" placeholder="Начните вводить имя друга">
					</div>
					<div class="items_list">
						<div class="items_list__title">Ваши друзья</div>
						<div class="items_list__list">
							<div class="user">
								<div class="user__content">
									<div class="avatar">
										<img src="" alt="" class="avatar__img">
									</div>
									<div class="user__name">Test</div>
								</div>
								<div class="user__controls">
									<button type="button" class="btn btn--add"></button>
								</div>
							</div>
						</div>
					</div>
					<div class="splash">
						<button class="btn btn--save">Сохранить</button>
					</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>